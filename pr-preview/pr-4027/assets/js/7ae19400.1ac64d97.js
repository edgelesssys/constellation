"use strict";(globalThis.webpackChunkconstellation_docs=globalThis.webpackChunkconstellation_docs||[]).push([[6154],{27513:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/max_latency-ae0fad7be416fae0d31ab35bb8284234.png"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var a=t(96540);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},41249:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/p99_latency-fd60c7ae80666133370f9b8e47404994.png"},42383:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>d,frontMatter:()=>r,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"overview/performance/application","title":"Application benchmarks","description":"HashiCorp Vault","source":"@site/versioned_docs/version-2.22/overview/performance/application.md","sourceDirName":"overview/performance","slug":"/overview/performance/application","permalink":"/constellation/2.22/overview/performance/application","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/constellation/edit/main/docs/versioned_docs/version-2.22/overview/performance/application.md","tags":[],"version":"2.22","frontMatter":{},"sidebar":"docs","previous":{"title":"I/O benchmarks","permalink":"/constellation/2.22/overview/performance/io"},"next":{"title":"License","permalink":"/constellation/2.22/overview/license"}}');var s=t(74848),i=t(28453);const r={},o="Application benchmarks",c={},l=[{value:"HashiCorp Vault",id:"hashicorp-vault",level:2},{value:"Results",id:"results",level:2},{value:"Visualization",id:"visualization",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components},{Details:a}=n;return a||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"application-benchmarks",children:"Application benchmarks"})}),"\n",(0,s.jsx)(n.h2,{id:"hashicorp-vault",children:"HashiCorp Vault"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://www.vaultproject.io/",children:"HashiCorp Vault"})," is a distributed secrets management software that can be deployed to Kubernetes.\nHashiCorp maintains a benchmarking tool for vault, ",(0,s.jsx)(n.a,{href:"https://github.com/hashicorp/vault-benchmark/",children:"vault-benchmark"}),".\nVault-benchmark generates load on a Vault deployment and measures response times."]}),"\n",(0,s.jsxs)(n.p,{children:["This article describes the results from running vault-benchmark on Constellation, AKS, and GKE.\nYou can find the setup for producing the data discussed in this article in the ",(0,s.jsx)(n.a,{href:"https://github.com/edgelesssys/vault-benchmarks",children:"vault-benchmarks"})," repository."]}),"\n",(0,s.jsxs)(n.p,{children:["The Vault API used during benchmarking is the ",(0,s.jsx)(n.a,{href:"https://developer.hashicorp.com/vault/docs/secrets/transit",children:"transits secret engine"}),".\nThis allows services to send data to Vault for encryption, decryption, signing, and verification."]}),"\n",(0,s.jsx)(n.h2,{id:"results",children:"Results"}),"\n",(0,s.jsx)(n.p,{children:"On each run, vault-benchmark sends requests and measures the latencies.\nThe measured latencies are aggregated through various statistical features.\nAfter running the benchmark n times, the arithmetic mean over a subset of the reported statistics is calculated.\nThe selected features are arithmetic mean, 99th percentile, minimum, and maximum."}),"\n",(0,s.jsx)(n.p,{children:"Arithmetic mean gives a general sense of the latency on each target.\nThe 99th percentile shows performance in (most likely) erroneous states.\nMinimum and maximum mark the range within which latency varies each run."}),"\n",(0,s.jsx)(n.p,{children:"The benchmark was configured with 1300 workers and 10 seconds per run.\nThose numbers were chosen empirically.\nThe latency was stabilizing at 10 seconds runtime, not changing with further increase.\nIncreasing the number of workers beyond 1300 leads to request failures, marking the limit Vault was able to handle in this setup.\nAll results are based on 100 runs."}),"\n",(0,s.jsx)(n.p,{children:"The following data was generated while running five replicas, one primary, and four standby nodes.\nAll numbers are in seconds if not indicated otherwise."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"========== Results AKS ==========\nMean:   mean: 1.632200, variance: 0.002057\nP99:    mean: 5.480679, variance: 2.263700\nMax:    mean: 6.651001, variance: 2.808401\nMin:    mean: 0.011415, variance: 0.000133\n========== Results GKE ==========\nMean:   mean: 1.656435, variance: 0.003615\nP99:    mean: 6.030807, variance: 3.955051\nMax:    mean: 7.164843, variance: 3.300004\nMin:    mean: 0.010233, variance: 0.000111\n========== Results C11n ==========\nMean:   mean: 1.651549, variance: 0.001610\nP99:    mean: 5.780422, variance: 3.016106\nMax:    mean: 6.942997, variance: 3.075796\nMin:    mean: 0.013774, variance: 0.000228\n========== AKS vs C11n ==========\nMean:   +1.171577 %  (AKS is faster)\nP99:    +5.185495 %  (AKS is faster)\nMax:    +4.205618 %  (AKS is faster)\nMin:    +17.128781 % (AKS is faster)\n========== GKE vs C11n ==========\nMean:   -0.295851 %  (GKE is slower)\nP99:    -4.331603 %  (GKE is slower)\nMax:    -3.195248 %  (GKE is slower)\nMin:    +25.710886 % (GKE is faster)\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Interpretation"}),": Latencies are all within ~5% of each other.\nAKS performs slightly better than GKE and Constellation (C11n) in all cases except minimum latency.\nMinimum latency is the lowest for GKE.\nCompared to GKE, Constellation had slightly lower peak latencies (99th percentile and maximum), indicating that Constellation could have handled slightly more concurrent accesses than GKE.\nOverall, performance is at comparable levels across all three distributions.\nBased on these numbers, you can use a similarly sized Constellation cluster to run your existing Vault deployment."]}),"\n",(0,s.jsx)(n.h3,{id:"visualization",children:"Visualization"}),"\n",(0,s.jsxs)(n.p,{children:["The following plots visualize the data presented above as ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Box_plot",children:"box plots"}),".\nThe whiskers denote the minimum and maximum.\nThe box stretches from the 25th to the 75th percentile, with the dividing bar marking the 50th percentile.\nThe circles outside the whiskers denote outliers."]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)("summary",{children:"Mean Latency"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Mean Latency",src:t(91138).A+"",width:"576",height:"576"})})]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)("summary",{children:"99th Percentile Latency"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"99th Percentile Latency",src:t(41249).A+"",width:"576",height:"576"})})]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)("summary",{children:"Maximum Latency"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Maximum Latency",src:t(27513).A+"",width:"576",height:"576"})})]}),"\n",(0,s.jsxs)(a,{children:[(0,s.jsx)("summary",{children:"Minimum Latency"}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Minimum Latency",src:t(91159).A+"",width:"576",height:"576"})})]})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},91138:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/mean_latency-4c041d48ebb1b521c92d464040e94031.png"},91159:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/min_latency-87ed51de18ebede26c314ff00d0e8e23.png"}}]);