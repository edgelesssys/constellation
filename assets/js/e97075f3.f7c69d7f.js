"use strict";(globalThis.webpackChunkconstellation_docs=globalThis.webpackChunkconstellation_docs||[]).push([[853],{1397:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"architecture/observability","title":"Observability","description":"In Kubernetes, observability is the ability to gain insight into the behavior and performance of applications.","source":"@site/versioned_docs/version-2.23/architecture/observability.md","sourceDirName":"architecture","slug":"/architecture/observability","permalink":"/constellation/2.23/architecture/observability","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/constellation/edit/main/docs/versioned_docs/version-2.23/architecture/observability.md","tags":[],"version":"2.23","frontMatter":{},"sidebar":"docs","previous":{"title":"Networking","permalink":"/constellation/2.23/architecture/networking"},"next":{"title":"Reference","permalink":"/constellation/2.23/category/reference"}}');var n=s(74848),r=s(28453);const a={},o="Observability",l={},c=[{value:"Cloud resource monitoring",id:"cloud-resource-monitoring",level:2},{value:"Metrics",id:"metrics",level:2},{value:"Logs",id:"logs",level:2},{value:"System logs",id:"system-logs",level:3},{value:"Kubernetes logs",id:"kubernetes-logs",level:3},{value:"Traces",id:"traces",level:2},{value:"Integrations",id:"integrations",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"observability",children:"Observability"})}),"\n",(0,n.jsx)(t.p,{children:'In Kubernetes, observability is the ability to gain insight into the behavior and performance of applications.\nIt helps identify and resolve issues more effectively, ensuring stability and performance of Kubernetes workloads, reducing downtime and outages, and improving efficiency.\nThe "three pillars of observability" are logs, metrics, and traces.'}),"\n",(0,n.jsx)(t.p,{children:"In the context of Confidential Computing, observability is a delicate subject and needs to be applied such that it doesn't leak any sensitive information.\nThe following gives an overview of where and how you can apply standard observability tools in Constellation."}),"\n",(0,n.jsx)(t.h2,{id:"cloud-resource-monitoring",children:"Cloud resource monitoring"}),"\n",(0,n.jsx)(t.p,{children:"While inaccessible, Constellation's nodes are still visible as black box VMs to the hypervisor.\nResource consumption, such as memory and CPU utilization, can be monitored from the outside and observed via the cloud platforms directly.\nSimilarly, other resources, such as storage and network and their respective metrics, are visible via the cloud platform."}),"\n",(0,n.jsx)(t.h2,{id:"metrics",children:"Metrics"}),"\n",(0,n.jsx)(t.p,{children:"Metrics are numeric representations of data measured over intervals of time. They're essential for understanding system health and gaining insights using telemetry signals."}),"\n",(0,n.jsxs)(t.p,{children:["By default, Constellation exposes the ",(0,n.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/cluster-administration/system-metrics/",children:"metrics for Kubernetes system components"})," inside the cluster.\nSimilarly, the ",(0,n.jsx)(t.a,{href:"https://etcd.io/docs/v3.5/metrics/",children:"etcd metrics"})," endpoints are exposed inside the cluster.\nThese ",(0,n.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/cluster-administration/system-metrics/#disabling-metrics",children:"metrics endpoints can be disabled"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["You can collect these cluster-internal metrics via tools such as ",(0,n.jsx)(t.a,{href:"https://prometheus.io/",children:"Prometheus"})," or the ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/de/elastic-stack/",children:"Elastic Stack"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["Constellation's CNI Cilium also supports ",(0,n.jsx)(t.a,{href:"https://docs.cilium.io/en/latest/observability/metrics/",children:"metrics via Prometheus endpoints"}),".\nHowever, in Constellation, they're disabled by default and must be enabled first."]}),"\n",(0,n.jsx)(t.h2,{id:"logs",children:"Logs"}),"\n",(0,n.jsx)(t.p,{children:"Logs represent discrete events that usually describe what's happening with your service.\nThe payload is an actual message emitted from your system along with a metadata section containing a timestamp, labels, and tracking identifiers."}),"\n",(0,n.jsx)(t.h3,{id:"system-logs",children:"System logs"}),"\n",(0,n.jsxs)(t.p,{children:["Detailed system-level logs are accessible via ",(0,n.jsx)(t.code,{children:"/var/log"})," and ",(0,n.jsx)(t.a,{href:"https://www.freedesktop.org/software/systemd/man/systemd-journald.service.html",children:"journald"})," on the nodes directly.\nThey can be collected from there, for example, via ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/guide/en/beats/filebeat/current/logstash-output.html",children:"Filebeat and Logstash"}),", which are tools of the ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/de/elastic-stack/",children:"Elastic Stack"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["In case of an error during the initialization, the CLI automatically collects the ",(0,n.jsx)(t.a,{href:"/constellation/2.23/architecture/microservices#bootstrapper",children:"Bootstrapper"})," logs and returns these as a file for ",(0,n.jsx)(t.a,{href:"/constellation/2.23/workflows/troubleshooting",children:"troubleshooting"}),". Here is an example of such an event:"]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-shell-session",children:'Cluster initialization failed. This error is not recoverable.\nTerminate your cluster and try again.\nFetched bootstrapper logs are stored in "constellation-cluster.log"\n'})}),"\n",(0,n.jsx)(t.h3,{id:"kubernetes-logs",children:"Kubernetes logs"}),"\n",(0,n.jsxs)(t.p,{children:["Constellation supports the ",(0,n.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/cluster-administration/logging/",children:"Kubernetes logging architecture"}),".\nBy default, logs are written to the nodes' encrypted state disks.\nThese include the Pod and container logs and the ",(0,n.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/cluster-administration/logging/#system-component-logs",children:"system component logs"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"/constellation/2.23/architecture/microservices",children:"Constellation services"})," run as Pods inside the ",(0,n.jsx)(t.code,{children:"kube-system"})," namespace and use the standard container logging mechanism.\nThe same applies for the ",(0,n.jsx)(t.a,{href:"https://docs.cilium.io/en/latest/operations/troubleshooting/#logs",children:"Cilium Pods"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["You can collect logs from within the cluster via tools such as ",(0,n.jsx)(t.a,{href:"https://github.com/fluent/fluentd",children:"Fluentd"}),", ",(0,n.jsx)(t.a,{href:"https://github.com/grafana/loki",children:"Loki"}),", or the ",(0,n.jsx)(t.a,{href:"https://www.elastic.co/de/elastic-stack/",children:"Elastic Stack"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"traces",children:"Traces"}),"\n",(0,n.jsx)(t.p,{children:"Modern systems are implemented as interconnected complex and distributed microservices. Understanding request flows and system communications is challenging, mainly because all systems in a chain need to be modified to propagate tracing information. Distributed tracing is a new approach to increasing observability and understanding performance bottlenecks. A trace represents consecutive events that reflect an end-to-end request path in a distributed system."}),"\n",(0,n.jsxs)(t.p,{children:["Constellation supports ",(0,n.jsx)(t.a,{href:"https://kubernetes.io/docs/concepts/cluster-administration/system-traces/",children:"traces for Kubernetes system components"}),".\nBy default, they're disabled and need to be enabled first."]}),"\n",(0,n.jsxs)(t.p,{children:["Similarly, Cilium can be enabled to ",(0,n.jsx)(t.a,{href:"https://cilium.io/use-cases/metrics-export/",children:"export traces"}),"."]}),"\n",(0,n.jsxs)(t.p,{children:["You can collect these traces via tools such as ",(0,n.jsx)(t.a,{href:"https://www.jaegertracing.io/",children:"Jaeger"})," or ",(0,n.jsx)(t.a,{href:"https://zipkin.io/",children:"Zipkin"}),"."]}),"\n",(0,n.jsx)(t.h2,{id:"integrations",children:"Integrations"}),"\n",(0,n.jsx)(t.p,{children:"Platforms and SaaS solutions such as Datadog, logz.io, Dynatrace, or New Relic facilitate the observability challenge for Kubernetes and provide all-in-one SaaS solutions.\nThey install agents into the cluster that collect metrics, logs, and tracing information and upload them into the data lake of the platform.\nTechnically, the agent-based approach is compatible with Constellation, and attaching these platforms is straightforward.\nHowever, you need to evaluate if the exported data might violate Constellation's compliance and privacy guarantees by uploading them to a third-party platform."})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,t,s)=>{s.d(t,{R:()=>a,x:()=>o});var i=s(96540);const n={},r=i.createContext(n);function a(e){const t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:a(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);