"use strict";(globalThis.webpackChunkconstellation_docs=globalThis.webpackChunkconstellation_docs||[]).push([[7625],{28453:(e,s,t)=>{t.d(s,{R:()=>o,x:()=>l});var n=t(96540);const r={},i=n.createContext(r);function o(e){const s=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function l(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(i.Provider,{value:s},e.children)}},37789:(e,s,t)=>{t.r(s),t.d(s,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"workflows/storage","title":"Use persistent storage","description":"Persistent storage in Kubernetes requires cloud-specific configuration.","source":"@site/docs/workflows/storage.md","sourceDirName":"workflows","slug":"/workflows/storage","permalink":"/constellation/next/workflows/storage","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/constellation/edit/main/docs/docs/workflows/storage.md","tags":[],"version":"current","frontMatter":{},"sidebar":"docs","previous":{"title":"Verify your cluster","permalink":"/constellation/next/workflows/verify-cluster"},"next":{"title":"Use the Terraform provider","permalink":"/constellation/next/workflows/terraform-provider"}}');var r=t(74848),i=t(28453);const o={},l="Use persistent storage",a={},c=[{value:"Confidential storage",id:"confidential-storage",level:2},{value:"CSI drivers",id:"csi-drivers",level:2},{value:"Installation",id:"installation",level:2},{value:"Change the default storage class",id:"change-the-default-storage-class",level:3}];function d(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{TabItem:t,Tabs:n}=s;return t||p("TabItem",!0),n||p("Tabs",!0),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.header,{children:(0,r.jsx)(s.h1,{id:"use-persistent-storage",children:"Use persistent storage"})}),"\n",(0,r.jsxs)(s.p,{children:["Persistent storage in Kubernetes requires cloud-specific configuration.\nFor abstraction of container storage, Kubernetes offers ",(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/storage/volumes/",children:"volumes"}),",\nallowing users to mount storage solutions directly into containers.\nThe ",(0,r.jsx)(s.a,{href:"https://kubernetes-csi.github.io/docs/",children:"Container Storage Interface (CSI)"})," is the standard interface for exposing arbitrary block and file storage systems into containers in Kubernetes.\nCloud service providers (CSPs) offer their own CSI-based solutions for cloud storage."]}),"\n",(0,r.jsx)(s.h2,{id:"confidential-storage",children:"Confidential storage"}),"\n",(0,r.jsxs)(s.p,{children:["Most cloud storage solutions support encryption, such as ",(0,r.jsx)(s.a,{href:"https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek",children:"GCE Persistent Disks (PD)"}),".\nConstellation supports the available CSI-based storage options for Kubernetes engines in AWS, Azure, GCP, and STACKIT.\nHowever, their encryption takes place in the storage backend and is managed by the CSP.\nThus, using the default CSI drivers for these storage types means trusting the CSP with your persistent data."]}),"\n",(0,r.jsxs)(s.p,{children:["To address this, Constellation provides CSI drivers for AWS EBS, Azure Disk, GCE PD, and OpenStack Cinder, offering ",(0,r.jsx)(s.a,{href:"/constellation/next/architecture/keys#storage-encryption",children:"encryption on the node level"}),". They enable transparent encryption for persistent volumes without needing to trust the cloud backend. Plaintext data never leaves the confidential VM context, offering you confidential storage."]}),"\n",(0,r.jsxs)(s.p,{children:["For more details see ",(0,r.jsx)(s.a,{href:"/constellation/next/architecture/encrypted-storage",children:"encrypted persistent storage"}),"."]}),"\n",(0,r.jsx)(s.h2,{id:"csi-drivers",children:"CSI drivers"}),"\n",(0,r.jsx)(s.p,{children:"Constellation supports the following drivers, which offer node-level encryption and optional integrity protection."}),"\n",(0,r.jsxs)(n,{groupId:"csp",children:[(0,r.jsx)(t,{value:"aws",label:"AWS",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Constellation CSI driver for AWS Elastic Block Store"}),"\nMount ",(0,r.jsx)(s.a,{href:"https://aws.amazon.com/ebs/",children:"Elastic Block Store"})," storage volumes into your Constellation cluster.\nFollow the instructions on how to ",(0,r.jsx)(s.a,{href:"#installation",children:"install the Constellation CSI driver"})," or check out the ",(0,r.jsx)(s.a,{href:"https://github.com/edgelesssys/constellation-aws-ebs-csi-driver",children:"repository"})," for more information."]})}),(0,r.jsx)(t,{value:"azure",label:"Azure",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Constellation CSI driver for Azure Disk"}),":\nMount Azure ",(0,r.jsx)(s.a,{href:"https://azure.microsoft.com/en-us/services/storage/disks/#overview",children:"Disk Storage"})," into your Constellation cluster.\nSee the instructions on how to ",(0,r.jsx)(s.a,{href:"#installation",children:"install the Constellation CSI driver"})," or check out the ",(0,r.jsx)(s.a,{href:"https://github.com/edgelesssys/constellation-azuredisk-csi-driver",children:"repository"})," for more information.\nSince Azure Disks are mounted as ",(0,r.jsx)(s.code,{children:"ReadWriteOnce"}),", they're only available to a single pod."]})}),(0,r.jsx)(t,{value:"gcp",label:"GCP",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Constellation CSI driver for GCP Persistent Disk"}),":\nMount ",(0,r.jsx)(s.a,{href:"https://cloud.google.com/persistent-disk",children:"Persistent Disk"})," block storage into your Constellation cluster.\nFollow the instructions on how to ",(0,r.jsx)(s.a,{href:"#installation",children:"install the Constellation CSI driver"})," or check out the ",(0,r.jsx)(s.a,{href:"https://github.com/edgelesssys/constellation-gcp-compute-persistent-disk-csi-driver",children:"repository"})," for more information."]})}),(0,r.jsx)(t,{value:"stackit",label:"STACKIT",children:(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Constellation CSI driver for STACKIT / OpenStack Cinder"}),"\nMount ",(0,r.jsx)(s.a,{href:"https://docs.openstack.org/cinder/latest/",children:"Cinder"})," block storage volumes into your Constellation cluster.\nFollow the instructions on how to ",(0,r.jsx)(s.a,{href:"#installation",children:"install the Constellation CSI driver"})," or check out the ",(0,r.jsx)(s.a,{href:"https://github.com/edgelesssys/constellation-cloud-provider-openstack",children:"repository"})," for more information."]})})]}),"\n",(0,r.jsxs)(s.p,{children:["Note that in case the options above aren't a suitable solution for you, Constellation is compatible with all other CSI-based storage options. For example, you can use ",(0,r.jsx)(s.a,{href:"https://docs.aws.amazon.com/en_en/eks/latest/userguide/efs-csi.html",children:"AWS EFS"}),", ",(0,r.jsx)(s.a,{href:"https://docs.microsoft.com/en-us/azure/storage/files/storage-files-introduction",children:"Azure Files"}),", or ",(0,r.jsx)(s.a,{href:"https://cloud.google.com/filestore",children:"GCP Filestore"})," with Constellation out of the box. Constellation is just not providing transparent encryption on the node level for these storage types yet."]}),"\n",(0,r.jsx)(s.h2,{id:"installation",children:"Installation"}),"\n",(0,r.jsxs)(s.p,{children:["The Constellation CLI automatically installs Constellation's CSI driver for the selected CSP in your cluster.\nIf you don't need a CSI driver or wish to deploy your own, you can disable the automatic installation by setting ",(0,r.jsx)(s.code,{children:"deployCSIDriver"})," to ",(0,r.jsx)(s.code,{children:"false"})," in your Constellation config file."]}),"\n",(0,r.jsxs)(n,{groupId:"csp",children:[(0,r.jsxs)(t,{value:"aws",label:"AWS",children:[(0,r.jsx)(s.p,{children:"AWS comes with two storage classes by default."}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsxs)(s.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html",children:["SSDs of ",(0,r.jsx)(s.code,{children:"gp3"})," type"]})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsxs)(s.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volume-types.html",children:["SSDs of ",(0,r.jsx)(s.code,{children:"gp3"})," type"]})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n",(0,r.jsx)(s.li,{children:"Integrity protection of data written to disk"}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsxs)(s.p,{children:["For more information on encryption algorithms and key sizes, refer to ",(0,r.jsx)(s.a,{href:"/constellation/next/architecture/encrypted-storage#cryptographic-algorithms",children:"cryptographic algorithms"}),"."]}),(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsxs)(s.p,{children:["The default storage class is set to ",(0,r.jsx)(s.code,{children:"encrypted-rwo"})," for performance reasons.\nIf you want integrity-protected storage, set the ",(0,r.jsx)(s.code,{children:"storageClassName"})," parameter of your persistent volume claim to ",(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"."]}),(0,r.jsxs)(s.p,{children:["Alternatively, you can create your own storage class with integrity protection enabled by adding ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: ext4-integrity"})," to the class ",(0,r.jsx)(s.code,{children:"parameters"}),".\nOr use another filesystem by specifying another file system type with the suffix ",(0,r.jsx)(s.code,{children:"-integrity"}),", e.g., ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: xfs-integrity"}),"."]}),(0,r.jsx)(s.p,{children:"Note that volume expansion isn't supported for integrity-protected disks."})]})]}),(0,r.jsxs)(t,{value:"azure",label:"Azure",children:[(0,r.jsx)(s.p,{children:"Azure comes with two storage classes by default."}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-types#standard-ssds",children:"Standard SSDs"})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsx)(s.a,{href:"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-types#premium-ssds",children:"Premium SSDs"})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n",(0,r.jsx)(s.li,{children:"Integrity protection of data written to disk"}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsxs)(s.p,{children:["For more information on encryption algorithms and key sizes, refer to ",(0,r.jsx)(s.a,{href:"/constellation/next/architecture/encrypted-storage#cryptographic-algorithms",children:"cryptographic algorithms"}),"."]}),(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsxs)(s.p,{children:["The default storage class is set to ",(0,r.jsx)(s.code,{children:"encrypted-rwo"})," for performance reasons.\nIf you want integrity-protected storage, set the ",(0,r.jsx)(s.code,{children:"storageClassName"})," parameter of your persistent volume claim to ",(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"."]}),(0,r.jsxs)(s.p,{children:["Alternatively, you can create your own storage class with integrity protection enabled by adding ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: ext4-integrity"})," to the class ",(0,r.jsx)(s.code,{children:"parameters"}),".\nOr use another filesystem by specifying another file system type with the suffix ",(0,r.jsx)(s.code,{children:"-integrity"}),", e.g., ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: xfs-integrity"}),"."]}),(0,r.jsx)(s.p,{children:"Note that volume expansion isn't supported for integrity-protected disks."})]})]}),(0,r.jsxs)(t,{value:"gcp",label:"GCP",children:[(0,r.jsx)(s.p,{children:"GCP comes with two storage classes by default."}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsx)(s.a,{href:"https://cloud.google.com/compute/docs/disks#pdspecs",children:"standard persistent disks"})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsx)(s.a,{href:"https://cloud.google.com/compute/docs/disks#pdspecs",children:"performance (SSD) persistent disks"})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n",(0,r.jsx)(s.li,{children:"Integrity protection of data written to disk"}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsxs)(s.p,{children:["For more information on encryption algorithms and key sizes, refer to ",(0,r.jsx)(s.a,{href:"/constellation/next/architecture/encrypted-storage#cryptographic-algorithms",children:"cryptographic algorithms"}),"."]}),(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsxs)(s.p,{children:["The default storage class is set to ",(0,r.jsx)(s.code,{children:"encrypted-rwo"})," for performance reasons.\nIf you want integrity-protected storage, set the ",(0,r.jsx)(s.code,{children:"storageClassName"})," parameter of your persistent volume claim to ",(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"."]}),(0,r.jsxs)(s.p,{children:["Alternatively, you can create your own storage class with integrity protection enabled by adding ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: ext4-integrity"})," to the class ",(0,r.jsx)(s.code,{children:"parameters"}),".\nOr use another filesystem by specifying another file system type with the suffix ",(0,r.jsx)(s.code,{children:"-integrity"}),", e.g., ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: xfs-integrity"}),"."]}),(0,r.jsx)(s.p,{children:"Note that volume expansion isn't supported for integrity-protected disks."})]})]}),(0,r.jsxs)(t,{value:"stackit",label:"STACKIT",children:[(0,r.jsx)(s.p,{children:"STACKIT comes with two storage classes by default."}),(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsxs)(s.a,{href:"https://docs.stackit.cloud/stackit/en/service-plans-blockstorage-75137974.html",children:["disks of ",(0,r.jsx)(s.code,{children:"storage_premium_perf1"})," type"]})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:[(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"\n",(0,r.jsxs)(s.ul,{children:["\n",(0,r.jsxs)(s.li,{children:["Uses ",(0,r.jsxs)(s.a,{href:"https://docs.stackit.cloud/stackit/en/service-plans-blockstorage-75137974.html",children:["disks of ",(0,r.jsx)(s.code,{children:"storage_premium_perf1"})," type"]})]}),"\n",(0,r.jsx)(s.li,{children:"ext-4 filesystem"}),"\n",(0,r.jsx)(s.li,{children:"Encryption of all data written to disk"}),"\n",(0,r.jsx)(s.li,{children:"Integrity protection of data written to disk"}),"\n"]}),"\n"]}),"\n"]}),(0,r.jsxs)(s.p,{children:["For more information on encryption algorithms and key sizes, refer to ",(0,r.jsx)(s.a,{href:"/constellation/next/architecture/encrypted-storage#cryptographic-algorithms",children:"cryptographic algorithms"}),"."]}),(0,r.jsxs)(s.admonition,{type:"info",children:[(0,r.jsxs)(s.p,{children:["The default storage class is set to ",(0,r.jsx)(s.code,{children:"encrypted-rwo"})," for performance reasons.\nIf you want integrity-protected storage, set the ",(0,r.jsx)(s.code,{children:"storageClassName"})," parameter of your persistent volume claim to ",(0,r.jsx)(s.code,{children:"integrity-encrypted-rwo"}),"."]}),(0,r.jsxs)(s.p,{children:["Alternatively, you can create your own storage class with integrity protection enabled by adding ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: ext4-integrity"})," to the class ",(0,r.jsx)(s.code,{children:"parameters"}),".\nOr use another filesystem by specifying another file system type with the suffix ",(0,r.jsx)(s.code,{children:"-integrity"}),", e.g., ",(0,r.jsx)(s.code,{children:"csi.storage.k8s.io/fstype: xfs-integrity"}),"."]}),(0,r.jsx)(s.p,{children:"Note that volume expansion isn't supported for integrity-protected disks."})]})]})]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsxs)(s.p,{children:["Create a ",(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/",children:"persistent volume"})]}),"\n",(0,r.jsxs)(s.p,{children:["A ",(0,r.jsx)(s.a,{href:"https://kubernetes.io/docs/concepts/storage/persistent-volumes/#persistentvolumeclaims",children:"persistent volume claim"})," is a request for storage with certain properties.\nIt can refer to a storage class.\nThe following creates a persistent volume claim, requesting 20 GB of storage via the ",(0,r.jsx)(s.code,{children:"encrypted-rwo"})," storage class:"]}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"cat <<EOF | kubectl apply -f -\nkind: PersistentVolumeClaim\napiVersion: v1\nmetadata:\n  name: pvc-example\n  namespace: default\nspec:\n  accessModes:\n  - ReadWriteOnce\n  storageClassName: encrypted-rwo\n  resources:\n    requests:\n      storage: 20Gi\nEOF\n"})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Create a Pod with persistent storage"}),"\n",(0,r.jsx)(s.p,{children:"You can assign a persistent volume claim to an application in need of persistent storage.\nThe mounted volume will persist restarts.\nThe following creates a pod that uses the previously created persistent volume claim:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"cat <<EOF | kubectl apply -f -\napiVersion: v1\nkind: Pod\nmetadata:\n  name: web-server\n  namespace: default\nspec:\n  containers:\n  - name: web-server\n    image: nginx\n    volumeMounts:\n    - mountPath: /var/lib/www/html\n      name: mypvc\n  volumes:\n  - name: mypvc\n    persistentVolumeClaim:\n      claimName: pvc-example\n      readOnly: false\nEOF\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(s.h3,{id:"change-the-default-storage-class",children:"Change the default storage class"}),"\n",(0,r.jsxs)(s.p,{children:["The default storage class is responsible for all persistent volume claims that don't explicitly request ",(0,r.jsx)(s.code,{children:"storageClassName"}),".\nConstellation creates a storage class with encryption enabled and sets this as the default class.\nIn case you wish to change it, follow the steps below:"]}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"List the storage classes in your cluster:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl get storageclass\n"})}),"\n",(0,r.jsx)(s.p,{children:"The output is similar to this:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell-session",children:"NAME                      PROVISIONER                         RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nencrypted-rwo (default)   {your-csp}.csi.confidential.cloud   Delete          Immediate           true                   1d\nintegrity-encrypted-rwo   {your-csp}.csi.confidential.cloud   Delete          Immediate           false                  1d\n"})}),"\n",(0,r.jsxs)(s.p,{children:["The default storage class is marked by ",(0,r.jsx)(s.code,{children:"(default)"}),"."]}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Mark old default storage class as non default"}),"\n",(0,r.jsx)(s.p,{children:"If you previously used another storage class as the default, you will have to remove that annotation:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'kubectl patch storageclass encrypted-rwo -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"false"}}}\'\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Mark new class as the default"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:'kubectl patch storageclass integrity-encrypted-rwo -p \'{"metadata": {"annotations":{"storageclass.kubernetes.io/is-default-class":"true"}}}\'\n'})}),"\n"]}),"\n",(0,r.jsxs)(s.li,{children:["\n",(0,r.jsx)(s.p,{children:"Verify that your chosen storage class is default:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-bash",children:"kubectl get storageclass\n"})}),"\n",(0,r.jsx)(s.p,{children:"The output is similar to this:"}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{className:"language-shell-session",children:"NAME                                PROVISIONER                         RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE\nencrypted-rwo                       {your-csp}.csi.confidential.cloud   Delete          Immediate           true                   1d\nintegrity-encrypted-rwo (default)   {your-csp}.csi.confidential.cloud   Delete          Immediate           false                  1d\n"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}function p(e,s){throw new Error("Expected "+(s?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);