"use strict";(globalThis.webpackChunkconstellation_docs=globalThis.webpackChunkconstellation_docs||[]).push([[3280],{28453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>i});var o=s(96540);const t={},r=o.createContext(t);function a(e){const n=o.useContext(r);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),o.createElement(r.Provider,{value:n},e.children)}},31327:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"workflows/lb","title":"Expose a service","description":"Constellation integrates the native load balancers of each CSP. Therefore, to expose a service simply create a service of type LoadBalancer.","source":"@site/versioned_docs/version-2.24/workflows/lb.md","sourceDirName":"workflows","slug":"/workflows/lb","permalink":"/constellation/workflows/lb","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/constellation/edit/main/docs/versioned_docs/version-2.24/workflows/lb.md","tags":[],"version":"2.24","frontMatter":{},"sidebar":"docs","previous":{"title":"Upgrade your cluster","permalink":"/constellation/workflows/upgrade"},"next":{"title":"Install cert-manager","permalink":"/constellation/workflows/cert-manager"}}');var t=s(74848),r=s(28453);const a={},i="Expose a service",c={},l=[{value:"Internet-facing LB service on AWS",id:"internet-facing-lb-service-on-aws",level:2},{value:"Ingress on AWS",id:"ingress-on-aws",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"expose-a-service",children:"Expose a service"})}),"\n",(0,t.jsxs)(n.p,{children:["Constellation integrates the native load balancers of each CSP. Therefore, to expose a service simply ",(0,t.jsxs)(n.a,{href:"https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer",children:["create a service of type ",(0,t.jsx)(n.code,{children:"LoadBalancer"})]}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"internet-facing-lb-service-on-aws",children:"Internet-facing LB service on AWS"}),"\n",(0,t.jsxs)(n.p,{children:["To expose your application service externally you might want to use a Kubernetes Service of type ",(0,t.jsx)(n.code,{children:"LoadBalancer"}),". On AWS, load-balancing is achieved through the ",(0,t.jsx)(n.a,{href:"https://kubernetes-sigs.github.io/aws-load-balancer-controller",children:"AWS Load Balancer Controller"})," as in the managed EKS."]}),"\n",(0,t.jsxs)(n.p,{children:["Since recent versions, the controller deploy an internal LB by default requiring to set an annotation ",(0,t.jsx)(n.code,{children:"service.beta.kubernetes.io/aws-load-balancer-scheme: internet-facing"})," to have an internet-facing LB. For more details, see the ",(0,t.jsx)(n.a,{href:"https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.7/guide/service/nlb/",children:"official docs"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["For general information on LB with AWS see ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/eks/latest/userguide/network-load-balancing.html",children:"Network load balancing on Amazon EKS"}),"."]}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"Before terminating the cluster, all LB backed services should be deleted, so that the controller can cleanup the related resources."})}),"\n",(0,t.jsx)(n.h2,{id:"ingress-on-aws",children:"Ingress on AWS"}),"\n",(0,t.jsxs)(n.p,{children:["The AWS Load Balancer Controller also provisions ",(0,t.jsx)(n.code,{children:"Ingress"})," resources of class ",(0,t.jsx)(n.code,{children:"alb"}),".\nAWS Application Load Balancers (ALBs) can be configured with a ",(0,t.jsx)(n.a,{href:"https://kubernetes-sigs.github.io/aws-load-balancer-controller/v2.7/guide/ingress/annotations/#target-type",children:(0,t.jsx)(n.code,{children:"target-type"})}),".\nThe target type ",(0,t.jsx)(n.code,{children:"ip"})," requires using the EKS container network solution, which makes it incompatible with Constellation.\nIf a service can be exposed on a ",(0,t.jsx)(n.code,{children:"NodePort"}),", the target type ",(0,t.jsx)(n.code,{children:"instance"})," can be used."]}),"\n",(0,t.jsxs)(n.p,{children:["See ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/eks/latest/userguide/alb-ingress.html",children:"Application load balancing on Amazon EKS"})," for more information."]}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsx)(n.p,{children:"Ingress handlers backed by AWS ALBs reside outside the Constellation cluster, so they shouldn't be handling sensitive traffic!"})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);