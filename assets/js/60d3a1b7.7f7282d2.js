"use strict";(globalThis.webpackChunkconstellation_docs=globalThis.webpackChunkconstellation_docs||[]).push([[6665],{28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>l});var i=s(96540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},97536:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"workflows/config","title":"Configure your cluster","description":"This recording presents the essence of this page. It\'s recommended to read it in full for the motivation and all details.","source":"@site/versioned_docs/version-2.23/workflows/config.md","sourceDirName":"workflows","slug":"/workflows/config","permalink":"/constellation/2.23/workflows/config","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/constellation/edit/main/docs/versioned_docs/version-2.23/workflows/config.md","tags":[],"version":"2.23","frontMatter":{},"sidebar":"docs","previous":{"title":"Verify the CLI","permalink":"/constellation/2.23/workflows/verify-cli"},"next":{"title":"Create your cluster","permalink":"/constellation/2.23/workflows/create"}}');var t=s(74848),o=s(28453);const r={},l="Configure your cluster",c={},a=[{value:"Creating the configuration file",id:"creating-the-configuration-file",level:2},{value:"Choosing a VM type",id:"choosing-a-vm-type",level:2},{value:"Creating additional node groups",id:"creating-additional-node-groups",level:2},{value:"Choosing a Kubernetes version",id:"choosing-a-kubernetes-version",level:2},{value:"Creating an IAM configuration",id:"creating-an-iam-configuration",level:2},{value:"Deleting an IAM configuration",id:"deleting-an-iam-configuration",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components},{AsciinemaWidget:s,Details:i,TabItem:r,Tabs:l}=n;return s||u("AsciinemaWidget",!0),i||u("Details",!0),r||u("TabItem",!0),l||u("Tabs",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"configure-your-cluster",children:"Configure your cluster"})}),"\n",(0,t.jsx)(n.admonition,{type:"info",children:(0,t.jsx)(n.p,{children:"This recording presents the essence of this page. It's recommended to read it in full for the motivation and all details."})}),"\n",(0,t.jsx)(s,{src:"/constellation/assets/configure-cluster.cast",rows:"20",cols:"112",idleTimeLimit:"3",preload:"true",theme:"edgeless"}),"\n",(0,t.jsx)(n.hr,{}),"\n",(0,t.jsx)(n.p,{children:"Before you can create your cluster, you need to configure the identity and access management (IAM) for your cloud service provider (CSP) and choose machine types for the nodes."}),"\n",(0,t.jsx)(n.h2,{id:"creating-the-configuration-file",children:"Creating the configuration file"}),"\n",(0,t.jsx)(n.p,{children:"You can generate a configuration file for your CSP by using the following CLI command:"}),"\n",(0,t.jsxs)(l,{groupId:"csp",children:[(0,t.jsx)(r,{value:"aws",label:"AWS",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation config generate aws\n"})})}),(0,t.jsx)(r,{value:"azure",label:"Azure",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation config generate azure\n"})})}),(0,t.jsx)(r,{value:"gcp",label:"GCP",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation config generate gcp\n"})})}),(0,t.jsx)(r,{value:"stackit",label:"STACKIT",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation config generate stackit\n"})})})]}),"\n",(0,t.jsxs)(n.p,{children:["This creates the file ",(0,t.jsx)(n.code,{children:"constellation-conf.yaml"})," in the current directory."]}),"\n",(0,t.jsx)(n.h2,{id:"choosing-a-vm-type",children:"Choosing a VM type"}),"\n",(0,t.jsx)(n.p,{children:"Constellation supports the following VM types:"}),"\n",(0,t.jsxs)(l,{groupId:"csp",children:[(0,t.jsxs)(r,{value:"aws",label:"AWS",children:[(0,t.jsxs)(n.p,{children:["By default, Constellation uses ",(0,t.jsx)(n.code,{children:"m6a.xlarge"})," VMs (4 vCPUs, 16 GB RAM) to create your cluster.\nOptionally, you can switch to a different VM type by modifying ",(0,t.jsx)(n.code,{children:"instanceType"})," in the configuration file.\nIf you are using the default attestation variant ",(0,t.jsx)(n.code,{children:"awsSEVSNP"}),", you can use the instance types described in ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/snp-requirements.html",children:"AWS's AMD SEV-SNP docs"}),".\nPlease mind the region restrictions mentioned in the ",(0,t.jsx)(n.a,{href:"/constellation/2.23/getting-started/first-steps#create-a-cluster",children:"Getting started"})," section."]}),(0,t.jsxs)(n.p,{children:["If you are using the attestation variant ",(0,t.jsx)(n.code,{children:"awsNitroTPM"}),", you can choose any of the ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/enable-nitrotpm-prerequisites.html",children:"nitroTPM-enabled instance types"}),"."]}),(0,t.jsxs)(n.p,{children:["The Constellation CLI can also print the supported instance types with: ",(0,t.jsx)(n.code,{children:"constellation config instance-types"}),"."]})]}),(0,t.jsxs)(r,{value:"azure",label:"Azure",children:[(0,t.jsxs)(n.p,{children:["By default, Constellation uses ",(0,t.jsx)(n.code,{children:"Standard_DC4as_v5"})," CVMs (4 vCPUs, 16 GB RAM) to create your cluster. Optionally, you can switch to a different VM type by modifying ",(0,t.jsx)(n.code,{children:"instanceType"})," in the configuration file. For CVMs, any VM type with a minimum of 4 vCPUs from the ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/virtual-machines/dcasv5-dcadsv5-series",children:"DCasv5 & DCadsv5"})," or ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/virtual-machines/ecasv5-ecadsv5-series",children:"ECasv5 & ECadsv5"})," families is supported."]}),(0,t.jsxs)(n.p,{children:["You can also run ",(0,t.jsx)(n.code,{children:"constellation config instance-types"})," to get the list of all supported options."]})]}),(0,t.jsx)(r,{value:"gcp",label:"GCP",children:(0,t.jsxs)(n.p,{children:["By default, Constellation uses ",(0,t.jsx)(n.code,{children:"n2d-standard-4"})," VMs (4 vCPUs, 16 GB RAM) to create your cluster. Optionally, you can switch to a different VM type by modifying ",(0,t.jsx)(n.code,{children:"instanceType"})," in the configuration file. Supported are all machines with a minimum of 4 vCPUs from the ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/compute-optimized-machines#c2d_machine_types",children:"C2D"})," or ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/general-purpose-machines#n2d_machines",children:"N2D"})," family. You can run  ",(0,t.jsx)(n.code,{children:"constellation config instance-types"})," to get the list of all supported options."]})}),(0,t.jsxs)(r,{value:"stackit",label:"STACKIT",children:[(0,t.jsxs)(n.p,{children:["By default, Constellation uses ",(0,t.jsx)(n.code,{children:"m1a.4cd"})," VMs (4 vCPUs, 30 GB RAM) to create your cluster.\nOptionally, you can switch to a different VM type by modifying ",(0,t.jsx)(n.code,{children:"instanceType"})," in the configuration file."]}),(0,t.jsx)(n.p,{children:"The following instance types are known to be supported:"}),(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"name"}),(0,t.jsx)(n.th,{children:"vCPUs"}),(0,t.jsx)(n.th,{children:"GB RAM"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"m1a.4cd"}),(0,t.jsx)(n.td,{children:"4"}),(0,t.jsx)(n.td,{children:"30"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"m1a.8cd"}),(0,t.jsx)(n.td,{children:"8"}),(0,t.jsx)(n.td,{children:"60"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"m1a.16cd"}),(0,t.jsx)(n.td,{children:"16"}),(0,t.jsx)(n.td,{children:"120"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"m1a.30cd"}),(0,t.jsx)(n.td,{children:"30"}),(0,t.jsx)(n.td,{children:"230"})]})]})]}),(0,t.jsxs)(n.p,{children:["You can choose any of the SEV-enabled instance types. You can find a list of all supported instance types in the ",(0,t.jsx)(n.a,{href:"https://docs.stackit.cloud/stackit/en/virtual-machine-flavors-75137231.html",children:"STACKIT documentation"}),"."]}),(0,t.jsxs)(n.p,{children:["The Constellation CLI can also print the supported instance types with: ",(0,t.jsx)(n.code,{children:"constellation config instance-types"}),"."]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["Fill the desired VM type into the ",(0,t.jsx)(n.code,{children:"instanceType"})," fields in the ",(0,t.jsx)(n.code,{children:"constellation-conf.yml"})," file."]}),"\n",(0,t.jsx)(n.h2,{id:"creating-additional-node-groups",children:"Creating additional node groups"}),"\n",(0,t.jsxs)(n.p,{children:["By default, Constellation creates the node groups ",(0,t.jsx)(n.code,{children:"control_plane_default"})," and ",(0,t.jsx)(n.code,{children:"worker_default"})," for control-plane nodes and workers, respectively.\nIf you require additional control-plane or worker groups with different instance types, zone placements, or disk sizes, you can add additional node groups to the ",(0,t.jsx)(n.code,{children:"constellation-conf.yml"})," file.\nEach node group can be scaled individually."]}),"\n",(0,t.jsx)(n.p,{children:"Consider the following example for AWS:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"nodeGroups:\n  control_plane_default:\n    role: control-plane\n    instanceType: c6a.xlarge\n    stateDiskSizeGB: 30\n    stateDiskType: gp3\n    zone: eu-west-1c\n    initialCount: 3\n  worker_default:\n    role: worker\n    instanceType: c6a.xlarge\n    stateDiskSizeGB: 30\n    stateDiskType: gp3\n    zone: eu-west-1c\n    initialCount: 2\n  high_cpu:\n    role: worker\n    instanceType: c6a.24xlarge\n    stateDiskSizeGB: 128\n    stateDiskType: gp3\n    zone: eu-west-1c\n    initialCount: 1\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This configuration creates an additional node group ",(0,t.jsx)(n.code,{children:"high_cpu"})," with a larger instance type and disk."]}),"\n",(0,t.jsxs)(n.p,{children:["You can use the field ",(0,t.jsx)(n.code,{children:"zone"})," to specify what availability zone nodes of the group are placed in.\nOn Azure, this field is empty by default and nodes are automatically spread across availability zones.\nSTACKIT currently offers SEV-enabled CPUs in the ",(0,t.jsx)(n.code,{children:"eu01-1"}),", ",(0,t.jsx)(n.code,{children:"eu01-2"}),", and ",(0,t.jsx)(n.code,{children:"eu01-3"})," zones.\nConsult the documentation of your cloud provider for more information:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://aws.amazon.com/about-aws/global-infrastructure/regions_az/",children:"AWS"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://azure.microsoft.com/en-us/explore/global-infrastructure/availability-zones",children:"Azure"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/regions-zones",children:"GCP"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.a,{href:"https://docs.stackit.cloud/stackit/en/regions-and-availability-zones-75137212.html",children:"STACKIT"})}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"choosing-a-kubernetes-version",children:"Choosing a Kubernetes version"}),"\n",(0,t.jsxs)(n.p,{children:["To learn which Kubernetes versions can be installed with your current CLI, you can run ",(0,t.jsx)(n.code,{children:"constellation config kubernetes-versions"}),".\nSee also Constellation's ",(0,t.jsx)(n.a,{href:"/constellation/2.23/architecture/versions#kubernetes-support-policy",children:"Kubernetes support policy"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"creating-an-iam-configuration",children:"Creating an IAM configuration"}),"\n",(0,t.jsxs)(n.p,{children:["You can create an IAM configuration for your cluster automatically using the ",(0,t.jsx)(n.code,{children:"constellation iam create"})," command.\nIf you already have a Constellation configuration file, you can add the ",(0,t.jsx)(n.code,{children:"--update-config"})," flag to the command. This writes the needed IAM fields into your configuration. Furthermore, the flag updates the zone/region of the configuration if it hasn't been set yet."]}),"\n",(0,t.jsxs)(l,{groupId:"csp",children:[(0,t.jsxs)(r,{value:"aws",label:"AWS",children:[(0,t.jsxs)(n.p,{children:["You must be authenticated with the ",(0,t.jsx)(n.a,{href:"https://aws.amazon.com/en/cli/",children:"AWS CLI"})," in the shell session with a user that has the ",(0,t.jsx)(n.a,{href:"/constellation/2.23/getting-started/install#set-up-cloud-credentials",children:"required permissions for IAM creation"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation iam create aws --zone=us-east-2a --prefix=constellTest\n"})}),(0,t.jsxs)(n.p,{children:["This command creates IAM configuration for the AWS zone ",(0,t.jsx)(n.code,{children:"us-east-2a"})," using the prefix ",(0,t.jsx)(n.code,{children:"constellTest"})," for all named resources being created."]}),(0,t.jsx)(n.p,{children:"Constellation OS images are currently replicated to the following regions:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eu-central-1"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eu-west-1"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eu-west-3"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"us-east-2"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"ap-south-1"})}),"\n"]}),(0,t.jsxs)(n.p,{children:["If you require the OS image to be available in another region, ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/issues/new?assignees=&labels=&template=feature_request.md&title=Support+new+AWS+image+region:+xx-xxxx-x",children:"let us know"}),"."]}),(0,t.jsxs)(n.p,{children:["You can find a list of all ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-available-regions",children:"regions in AWS's documentation"}),"."]}),(0,t.jsxs)(n.p,{children:["Paste the output into the corresponding fields of the ",(0,t.jsx)(n.code,{children:"constellation-conf.yaml"})," file."]})]}),(0,t.jsxs)(r,{value:"azure",label:"Azure",children:[(0,t.jsxs)(n.p,{children:["You must be authenticated with the ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/cli/azure/install-azure-cli",children:"Azure CLI"})," in the shell session with a user that has the ",(0,t.jsx)(n.a,{href:"/constellation/2.23/getting-started/install#set-up-cloud-credentials",children:"required permissions for IAM creation"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation iam create azure --subscriptionID 00000000-0000-0000-0000-000000000000 --region=westus --resourceGroup=constellTest --servicePrincipal=spTest\n"})}),(0,t.jsxs)(n.p,{children:["This command creates IAM configuration on the Azure region ",(0,t.jsx)(n.code,{children:"westus"})," creating a new resource group ",(0,t.jsx)(n.code,{children:"constellTest"})," and a new service principal ",(0,t.jsx)(n.code,{children:"spTest"}),"."]}),(0,t.jsx)(n.p,{children:"CVMs are available in several Azure regions. Constellation OS images are currently replicated to the following:"}),(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"germanywestcentral"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"westus"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eastus"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"northeurope"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"westeurope"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"southeastasia"})}),"\n"]}),(0,t.jsxs)(n.p,{children:["If you require the OS image to be available in another region, ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/issues/new?assignees=&labels=&template=feature_request.md&title=Support+new+Azure+image+region:+xx-xxxx-x",children:"let us know"}),"."]}),(0,t.jsxs)(n.p,{children:["You can find a list of all ",(0,t.jsx)(n.a,{href:"https://azure.microsoft.com/en-us/global-infrastructure/services/?products=virtual-machines&regions=all",children:"regions in Azure's documentation"}),"."]}),(0,t.jsxs)(n.p,{children:["Paste the output into the corresponding fields of the ",(0,t.jsx)(n.code,{children:"constellation-conf.yaml"})," file."]})]}),(0,t.jsxs)(r,{value:"gcp",label:"GCP",children:[(0,t.jsxs)(n.p,{children:["You must be authenticated with the ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/sdk/gcloud",children:"GCP CLI"})," in the shell session with a user that has the ",(0,t.jsx)(n.a,{href:"/constellation/2.23/getting-started/install#set-up-cloud-credentials",children:"required permissions for IAM creation"}),"."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation iam create gcp --projectID=yourproject-12345 --zone=europe-west3-a --prefix=constell-test\n"})}),(0,t.jsxs)(n.p,{children:["This command creates IAM configuration in the GCP project ",(0,t.jsx)(n.code,{children:"yourproject-12345"})," on the GCP zone ",(0,t.jsx)(n.code,{children:"europe-west3-a"})," creating a new service account ",(0,t.jsx)(n.code,{children:"constell-test"}),"."]}),(0,t.jsxs)(n.p,{children:["Note that only regions offering CVMs of the ",(0,t.jsx)(n.code,{children:"C2D"})," or ",(0,t.jsx)(n.code,{children:"N2D"})," series are supported. You can find a ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/regions-zones#available",children:"list of all regions in Google's documentation"}),", which you can filter by machine type ",(0,t.jsx)(n.code,{children:"N2D"}),"."]}),(0,t.jsxs)(n.p,{children:["Paste the output into the corresponding fields of the ",(0,t.jsx)(n.code,{children:"constellation-conf.yaml"})," file."]})]}),(0,t.jsx)(r,{value:"stackit",label:"STACKIT",children:(0,t.jsxs)(n.p,{children:["STACKIT requires manual creation and configuration of service accounts. Look at the ",(0,t.jsx)(n.a,{href:"/constellation/2.23/getting-started/first-steps",children:"first steps"})," for more information."]})})]}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:"Alternatively, you can manually create the IAM configuration on your CSP."}),(0,t.jsx)(n.p,{children:"The following describes the configuration fields and how you obtain the required information or create the required resources."}),(0,t.jsxs)(l,{groupId:"csp",children:[(0,t.jsx)(r,{value:"aws",label:"AWS",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"region"}),": The name of your chosen AWS data center region, e.g., ",(0,t.jsx)(n.code,{children:"us-east-2"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"Constellation OS images are currently replicated to the following regions:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eu-central-1"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eu-west-1"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eu-west-3"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"us-east-2"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"ap-south-1"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If you require the OS image to be available in another region, ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/issues/new?assignees=&labels=&template=feature_request.md&title=Support+new+AWS+image+region:+xx-xxxx-x",children:"let us know"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can find a list of all ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-available-regions",children:"regions in AWS's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"zone"}),": The name of your chosen AWS data center availability zone, e.g., ",(0,t.jsx)(n.code,{children:"us-east-2a"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Learn more about ",(0,t.jsx)(n.a,{href:"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#concepts-availability-zones",children:"availability zones in AWS's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"iamProfileControlPlane"}),": The name of an IAM instance profile attached to all control-plane nodes."]}),"\n",(0,t.jsxs)(n.p,{children:["You can create the resource with ",(0,t.jsx)(n.a,{href:"https://www.terraform.io/",children:"Terraform"}),". For that, use the ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/tree/release/v2.2/hack/terraform/aws/iam",children:"provided Terraform script"})," to generate the necessary profile. The profile name will be provided as Terraform output value: ",(0,t.jsx)(n.code,{children:"control_plane_instance_profile_name"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Alternatively, you can create the AWS profile with a tool of your choice. Use the JSON policy in ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/tree/release/v2.2/hack/terraform/aws/iam/main.tf",children:"main.tf"})," in the resource ",(0,t.jsx)(n.code,{children:"aws_iam_policy.control_plane_policy"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"iamProfileWorkerNodes"}),": The name of an IAM instance profile attached to all worker nodes."]}),"\n",(0,t.jsxs)(n.p,{children:["You can create the resource with ",(0,t.jsx)(n.a,{href:"https://www.terraform.io/",children:"Terraform"}),". For that, use the ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/tree/release/v2.2/hack/terraform/aws/iam",children:"provided Terraform script"})," to generate the necessary profile. The profile name will be provided as Terraform output value: ",(0,t.jsx)(n.code,{children:"worker_nodes_instance_profile_name"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["Alternatively, you can create the AWS profile with a tool of your choice. Use the JSON policy in ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/tree/release/v2.2/hack/terraform/aws/iam/main.tf",children:"main.tf"})," in the resource ",(0,t.jsx)(n.code,{children:"aws_iam_policy.worker_node_policy"}),"."]}),"\n"]}),"\n"]})}),(0,t.jsx)(r,{value:"azure",label:"Azure",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"subscription"}),": The UUID of your Azure subscription, e.g., ",(0,t.jsx)(n.code,{children:"8b8bd01f-efd9-4113-9bd1-c82137c32da7"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can view your subscription UUID via ",(0,t.jsx)(n.code,{children:"az account show"})," and read the ",(0,t.jsx)(n.code,{children:"id"})," field. For more information refer to ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/azure-portal/get-subscription-tenant-id#find-your-azure-subscription",children:"Azure's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"tenant"}),": The UUID of your Azure tenant, e.g., ",(0,t.jsx)(n.code,{children:"3400e5a2-8fe2-492a-886c-38cb66170f25"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can view your tenant UUID via ",(0,t.jsx)(n.code,{children:"az account show"})," and read the ",(0,t.jsx)(n.code,{children:"tenant"})," field. For more information refer to ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/azure-portal/get-subscription-tenant-id#find-your-azure-ad-tenant",children:"Azure's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"location"}),": The Azure datacenter location you want to deploy your cluster in, e.g., ",(0,t.jsx)(n.code,{children:"westus"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"CVMs are available in several Azure regions. Constellation OS images are currently replicated to the following:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"germanywestcentral"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"westus"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"eastus"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"northeurope"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"westeurope"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"southeastasia"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["If you require the OS image to be available in another region, ",(0,t.jsx)(n.a,{href:"https://github.com/edgelesssys/constellation/issues/new?assignees=&labels=&template=feature_request.md&title=Support+new+Azure+image+region:+xx-xxxx-x",children:"let us know"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can find a list of all ",(0,t.jsx)(n.a,{href:"https://azure.microsoft.com/en-us/global-infrastructure/services/?products=virtual-machines&regions=all",children:"regions in Azure's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"resourceGroup"}),": ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/azure/azure-resource-manager/management/manage-resource-groups-portal",children:"Create a new resource group in Azure"})," for your Constellation cluster. Set this configuration     field to the name of the created resource group."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"userAssignedIdentity"}),": ",(0,t.jsx)(n.a,{href:"https://learn.microsoft.com/azure/active-directory/managed-identities-azure-resources/how-manage-user-assigned-managed-identities",children:"Create a new managed identity in Azure"}),". You should create the identity in a different resource group as all resources within the cluster resource group will be deleted on cluster termination."]}),"\n",(0,t.jsxs)(n.p,{children:["Add three role assignments to the identity: ",(0,t.jsx)(n.code,{children:"Owner"}),", ",(0,t.jsx)(n.code,{children:"Virtual Machine Contributor"}),", and ",(0,t.jsx)(n.code,{children:"Application Insights Component Contributor"}),". The ",(0,t.jsx)(n.code,{children:"scope"})," of all three should refer to the previously created cluster resource group."]}),"\n",(0,t.jsxs)(n.p,{children:["Set the configuration value to the full ID of the created identity, e.g., ",(0,t.jsx)(n.code,{children:"/subscriptions/8b8bd01f-efd9-4113-9bd1-c82137c32da7/resourcegroups/constellation-identity/providers/Microsoft.ManagedIdentity/userAssignedIdentities/constellation-identity"}),". You can get it by opening the ",(0,t.jsx)(n.code,{children:"JSON View"})," from the ",(0,t.jsx)(n.code,{children:"Overview"})," section of the identity."]}),"\n",(0,t.jsxs)(n.p,{children:["The user-assigned identity is used by instances of the cluster to access other cloud resources.\nFor more information about managed identities refer to ",(0,t.jsx)(n.a,{href:"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/how-manage-user-assigned-managed-identities",children:"Azure's documentation"}),"."]}),"\n"]}),"\n"]})}),(0,t.jsx)(r,{value:"gcp",label:"GCP",children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"project"}),": The ID of your GCP project, e.g., ",(0,t.jsx)(n.code,{children:"constellation-129857"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can find it on the ",(0,t.jsx)(n.a,{href:"https://console.cloud.google.com/welcome",children:"welcome screen of your GCP project"}),". For more information refer to ",(0,t.jsx)(n.a,{href:"https://support.google.com/googleapi/answer/7014113",children:"Google's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"region"}),": The GCP region you want to deploy your cluster in, e.g., ",(0,t.jsx)(n.code,{children:"us-central1"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can find a ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/regions-zones#available",children:"list of all regions in Google's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"zone"}),": The GCP zone you want to deploy your cluster in, e.g., ",(0,t.jsx)(n.code,{children:"us-central1-a"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["You can find a ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/compute/docs/regions-zones#available",children:"list of all zones in Google's documentation"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"serviceAccountKeyPath"}),": To configure this, you need to create a GCP ",(0,t.jsx)(n.a,{href:"https://cloud.google.com/iam/docs/service-accounts",children:"service account"})," with the following permissions:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Compute Instance Admin (v1) (roles/compute.instanceAdmin.v1)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Compute Network Admin (roles/compute.networkAdmin)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Compute Security Admin (roles/compute.securityAdmin)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Compute Storage Admin (roles/compute.storageAdmin)"})}),"\n",(0,t.jsx)(n.li,{children:(0,t.jsx)(n.code,{children:"Service Account User (roles/iam.serviceAccountUser)"})}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Afterward, create and download a new JSON key for this service account. Place the downloaded file in your Constellation workspace, and set the config parameter to the filename, e.g., ",(0,t.jsx)(n.code,{children:"constellation-129857-15343dba46cb.json"}),"."]}),"\n"]}),"\n"]})}),(0,t.jsx)(r,{value:"stackit",label:"STACKIT",children:(0,t.jsxs)(n.p,{children:["STACKIT requires manual creation and configuration of service accounts. Look at the ",(0,t.jsx)(n.a,{href:"/constellation/2.23/getting-started/first-steps",children:"first steps"})," for more information."]})})]})]}),"\n",(0,t.jsxs)(n.p,{children:["Now that you've configured your CSP, you can ",(0,t.jsx)(n.a,{href:"/constellation/2.23/workflows/create",children:"create your cluster"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"deleting-an-iam-configuration",children:"Deleting an IAM configuration"}),"\n",(0,t.jsx)(n.p,{children:"You can keep a created IAM configuration and reuse it for new clusters. Alternatively, you can also delete it if you don't want to use it anymore."}),"\n",(0,t.jsxs)(n.p,{children:["Delete the IAM configuration by executing the following command in the same directory where you executed ",(0,t.jsx)(n.code,{children:"constellation iam create"})," (the directory that contains ",(0,t.jsx)(n.a,{href:"/constellation/2.23/reference/terraform",children:(0,t.jsx)(n.code,{children:"constellation-iam-terraform"})})," as a subdirectory):"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"constellation iam destroy\n"})}),"\n",(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["For Azure, deleting the IAM configuration by executing ",(0,t.jsx)(n.code,{children:"constellation iam destroy"})," will delete the whole resource group created by ",(0,t.jsx)(n.code,{children:"constellation iam create"}),".\nThis also includes any additional resources in the resource group that weren't created by Constellation."]})})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}function u(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}}}]);