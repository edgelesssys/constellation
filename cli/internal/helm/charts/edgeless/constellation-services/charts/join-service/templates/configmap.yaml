apiVersion: v1
kind: ConfigMap
metadata:
  name: join-config
  namespace: kube-system
data:
  # mustToJson is required so the json-strings passed from go are of type string in the rendered yaml.
  enforcedPCRs: {{ .Values.enforcedPCRs | mustToJson }}
  measurements: {{ .Values.measurements | mustToJson }}
  {{- if eq .Values.csp "Azure" }}
  # ConfigMap.data is of type map[string]string. quote will not quote a quoted string.
  enforceIdKeyDigest: {{ .Values.enforceIdKeyDigest | quote }}
  idkeydigest: {{ .Values.idkeydigest }}
  {{- end }}
binaryData:
  measurementSalt: {{ .Values.measurementSalt }}
