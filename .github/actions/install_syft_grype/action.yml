name: Install Syft & Grype
description: |
  Installs Syft & Grype.
inputs:
  os:
    description: "Download build of Syft & Grype for operating system [linux, darwin]"
    default: "linux"
    required: false
  arch:
    description: "Download build of Syft & Grype for architecture [amd64, arm64]"
    default: "amd64"
    required: false

runs:
  using: "composite"
  steps:
    - name: Install Syft & Grype
      shell: bash
      working-directory: /tmp
      env:
        SYFT_VERSION: "0.66.2"
        GRYPE_VRSION: "0.55.0"
      run: |
        curl -Lo syft_${SYFT_VERSION}_${{ inputs.os }}_${{ inputs.arch }}.tar.gz https://github.com/anchore/syft/releases/download/v${SYFT_VERSION}/syft_${SYFT_VERSION}_${{ inputs.os }}_${{ inputs.arch }}.tar.gz
        tar -xzf syft_${SYFT_VERSION}_${{ inputs.os }}_${{ inputs.arch }}.tar.gz
        sudo install syft /usr/bin/syft
        syft version
        curl -Lo grype_${GRYPE_VERSION}_${{ inputs.os }}_${{ inputs.arch }}.tar.gz https://github.com/anchore/grype/releases/download/v${GRYPE_VERSION}/grype_${GRYPE_VERSION}_${{ inputs.os }}_${{ inputs.arch }}.tar.gz
        tar -xzf grype_${GRYPE_VERSION}_${{ inputs.os }}_${{ inputs.arch }}.tar.gz
        sudo install grype /usr/bin/grype
        grype version
