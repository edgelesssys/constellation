name: versionsapi
description: "A GitHub Action to interact with the versions API"

#
# !!! Attention !!!
#
# Calls with command 'add' and 'remove' need synchronization.
# Don't use this action directly for these commands.
# Use the 'versionsapi' workflow instead.
#

inputs:
  command:
    description: Command to run
    required: true
  ref:
    description: --ref flag
    required: false
  stream:
    description: --stream flag
    required: false
  version:
    description: --version flag
    required: false
  add_latest:
    description: --latest flag (boolean)
    required: false
    default: "false"
  add_release:
    description: --release flag (boolean)
    required: false
    default: "false"
  rm_all:
    description: --all flag (boolean)
    required: false
    default: "false"
  dryrun:
    description: --dryrun flag (boolean)
    required: false
    default: "false"
outputs:
  output:
    description: Output of the command

runs:
  using: docker
  image: docker://ghcr.io/edgelesssys/constellation/versionsapi-ci-cli:latest
  args:
    - ${{ inputs.command }}
    - ${{ inputs.ref != '' && format('--ref={0}', inputs.ref) || '' }}
    - ${{ inputs.stream != '' && format('--stream={0}', inputs.stream) || '' }}
    - ${{ inputs.version != '' && format('--version={0}', inputs.version) || '' }}
    - ${{ inputs.add_latest == 'true' && '--latest' || '' }}
    - ${{ inputs.add_release == 'true' && '--release' || '' }}
    - ${{ inputs.rm_all == 'true' && '--all' || '' }}
    - ${{ inputs.dryrun == 'true' && '--dryrun' || '' }}
    - --verbose
