name: GCP login
description: "Login to GCP & configure gcloud CLI."
inputs:
  gcp_service_account_json:
    description: "Service account with permissions to create Constellation on GCP."
    required: true
runs:
  using: "composite"
  steps:
    # As described at:
    # https://github.com/google-github-actions/setup-gcloud#service-account-key-json
    - name: Authorize GCP access
      uses: google-github-actions/auth@ef5d53e30bbcd8d0836f4288f5e50ff3e086997d # v1.0.0
      with:
        credentials_json: ${{ inputs.gcp_service_account_json }}

    # Even if preinstalled in Github Actions runner image, this setup does some magic authentication required for gsutil.
    - name: Set up Cloud SDK
      uses: google-github-actions/setup-gcloud@ee9693ff89cdf73862b8a13988f6a71070e8fc58 # tag=v0.6.2
