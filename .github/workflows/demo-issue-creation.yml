name: demo-issue-creation

on:
  workflow_dispatch:
  pull_request:

jobs:
    e2e-daily:
      strategy:
        matrix:
          kubernetesVersion: ["1.28"] # should be default
          provider: ["azure"]
          refStream: ["ref/main/stream/debug/?"]
          test: ["autoscaling"]
      runs-on: ubuntu-22.04
      permissions:
        id-token: write
        checks: write
        contents: read
        packages: write
      steps:
        - name: Check out repository
          uses: actions/checkout@b4ffde65f46336ab88eb53be808477a3936bae11 # v4.1.1
          with:
            fetch-depth: 0
            ref: ${{ !github.event.pull_request.head.repo.fork && github.head_ref || '' }}
  
        - name: Notify about failure
          continue-on-error: true
          uses: ./.github/actions/notify_e2e_failure
          with:
            projectWriteToken: ${{ secrets.PROJECT_WRITE_TOKEN }}
            refStream: ${{ matrix.refStream }}
            test: ${{ matrix.test }}
            kubernetesVersion: ${{ matrix.kubernetesVersion }}
            provider: ${{ matrix.provider }}
            clusterCreation: "cli"
