defaultBaseImage: ghcr.io/edgelesssys/apko-alpine-base:v2.7.0-pre.0.20230330140329-cf3fb3a725e1@sha256:b57063d5894acfe0193d5733b9c5fcee609e76f9dcb580a015e5b8274066fce1

baseImageOverrides:
  github.com/edgelesssys/constellation/operators/constellation-node-operator/v2: ghcr.io/edgelesssys/apko-alpine-base-user-65532:v2.7.0-pre.0.20230330140329-cf3fb3a725e1@sha256:6a4572b4d42e320e63e01851c8d9b5832a588a10440c2990a2527e128983ae2e
  github.com/edgelesssys/constellation/v2/hack/qemu-metadata-api: ghcr.io/edgelesssys/apko-alpine-qemu-metadata-api:v2.7.0-pre.0.20230330140329-cf3fb3a725e1@sha256:dd9f999ebe8828d6794c0b34fdf053f056afde82af73bfeee890ac4b834c9adf

builds:
  - id: keyservice
    dir: .
    main: ./keyservice/cmd
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: joinservice
    dir: .
    main: ./joinservice/cmd
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: constellation-node-operator
    dir: .
    main: ./operators/constellation-node-operator/
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: verification-service
    dir: .
    main: ./verify/cmd
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: qemu-metadata-api
    dir: .
    main: ./hack/qemu-metadata-api/
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
