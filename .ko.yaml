defaultBaseImage: ghcr.io/edgelesssys/apko-alpine-base:v2.6.0-pre.0.20230213162659-86ab0bcfe2bf@sha256:afde7fb16090ecafdb0b166f4d8d7d06dd7dcf8bcd5b0e4ed22140a0dea34afa

baseImageOverrides:
  github.com/edgelesssys/constellation/operators/constellation-node-operator/v2: ghcr.io/edgelesssys/apko-alpine-base-user-65532:v2.6.0-pre.0.20230213162659-86ab0bcfe2bf@sha256:9474c40dfa32ff6c3390af27db94e2327ba3e3b8c5815b0495a9c3ab47468112
  github.com/edgelesssys/constellation/v2/hack/qemu-metadata-api: ghcr.io/edgelesssys/apko-alpine-qemu-metadata-api:v2.6.0-pre.0.20230213162659-86ab0bcfe2bf@sha256:96e08c48de4ad53a181bb95824317cda3669de46de4578f497fb54d3d231f95a

builds:
  - id: keyservice
    dir: .
    main: ./keyservice/cmd
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: joinservice
    dir: .
    main: ./joinservice/cmd
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: constellation-node-operator
    dir: .
    main: ./operators/constellation-node-operator/
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: verification-service
    dir: .
    main: ./verify/cmd
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
      - -extldflags "-static"

  - id: qemu-metadata-api
    dir: .
    main: ./hack/qemu-metadata-api/
    env:
      - CGO_ENABLED=0
      - GOOS=linux
      - GOARCH=amd64
    flags:
      - -trimpath
      - -buildvcs=false
      - -a
    ldflags:
      - -s -w -buildid=''
