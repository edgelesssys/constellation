defaultBaseImage: ghcr.io/edgelesssys/apko-alpine-base:latest

baseImageOverrides:
  github.com/edgelesssys/constellation/operators/constellation-node-operator/v2: ghcr.io/edgelesssys/apko-alpine-base-user-65532
  github.com/edgelesssys/constellation/v2/hack/qemu-metadata-api: ghcr.io/edgelesssys/apko-alpine-qemu-metadata-api

builds:
- id: kms
  dir: .
  main: ./kms/cmd
  env:
  - CGO_ENABLED=0
  - GOOS=linux
  - GOARCH=amd64
  flags:
  - -trimpath
  - -buildvcs=false
  - -a
  ldflags:
  - -s -w -buildid=''
  - -extldflags "-static"

- id: joinservice
  dir: .
  main: ./joinservice/cmd
  env:
  - CGO_ENABLED=0
  - GOOS=linux
  - GOARCH=amd64
  flags:
  - -trimpath
  - -buildvcs=false
  - -a
  ldflags:
  - -s -w -buildid=''
  - -extldflags "-static"

- id: constellation-node-operator
  dir: .
  main: ./operators/constellation-node-operator/
  env:
  - CGO_ENABLED=0
  - GOOS=linux
  - GOARCH=amd64
  flags:
  - -trimpath
  - -buildvcs=false
  - -a
  ldflags:
  - -s -w -buildid=''
  - -extldflags "-static"

- id: verification-service
  dir: .
  main: ./verify/cmd
  env:
  - CGO_ENABLED=0
  - GOOS=linux
  - GOARCH=amd64
  flags:
  - -trimpath
  - -buildvcs=false
  - -a
  ldflags:
  - -s -w -buildid=''
  - -extldflags "-static"

- id: qemu-metadata-api
  dir: .
  main: ./hack/qemu-metadata-api/
  env:
  - CGO_ENABLED=0
  - GOOS=linux
  - GOARCH=amd64
  flags:
  - -trimpath
  - -buildvcs=false
  - -a
  ldflags:
  - -s -w -buildid=''
